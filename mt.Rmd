---
title: "Analysis of socio-economic standards among various countries and continents"
author: "Aman"
date: "16/11/2017"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Introduction

Socioeconomics (also known as social economics) is the social science that studies how economic activity affects and is shaped by social processes. In general it analyzes how societies progress, stagnate, or regress because of their local or regional economy, or the global economy. Various parameters such as GDP per capita, population growth and life expectancy have been a reliable means used to measure the progress of societies.

Here we will be analysing the socioeconomic conditions across five continents from a period of 1952 to 2007. The dataset under investigation is `Gapminder` dataset for further details please refer to [Gapminder](https://www.gapminder.org/). Features present in the analysis and their definitions

Feature          |        Definition
---------------- |------------------------
Country          | Name of the country
Continent        | Name of the continent
Year             | Year observation was recorded
lifeExp          | Life expectancy is a statistical measure of the average time an organism is expected to live, based on the year of their birth, their current age and other demographic factors including sex.
pop              | Population of the country in specific year
gdpPercap        | GDP - per capita (PPP) compares GDP on a purchasing power parity basis divided by population as of 1 July for the same year.


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(gapminder)
library(ggplot2)
library(dplyr)
library(ggrepel)
library(directlabels)
library(knitr)
library(scales)
library(stargazer)
library(pander)
```

Lets have a general overview of the data, the first number represents the number of rows or observations and next number represents number of columns or features present in the dataset. We can also see the features mentioned above.
 **Number of rows = 1704** and **number of columns = 6**, Number of countries

```{r, echo=FALSE}
kable(gapminder[1:5, ], caption = "A table")

gapSummary <- apply(gapminder[, 4:6], 2, function(x) tapply(x, gapminder$continent, 
    summary))
gapminderSummary <- lapply(gapSummary, do.call, what = rbind)


suppressPackageStartupMessages(library(pander))
panderOptions("table.split.table", Inf)  ## don't split tables
pander(gapminderSummary[1:3])

pander(for (i in 1:3) {
    set.caption(sub(".", " ", names(gapminderSummary)[i], fixed = TRUE))
    pander(gapminderSummary[[i]])
})

model <- lm( lifeExp ~ gdpPercap, data = gapminder)
pander(summary(model))
pander(anova(model))


```



```{r, echo=FALSE}

year <- as.factor(gapminder$year)
year <- unique(year)
str(year)

```


Here we can see that we have 142 countries, 5 continents and 12 times the observation was taken from 1952 to 2007. **Observations were taken after every five years**

##Steps taken
1. Data cleansing (if required)
2. Data transformation
3. Visualisations
```{r echo=FALSE, out.width='100%', message=FALSE}
knitr::include_graphics('./data-science.png')

```


Now let's compare the situations back in  1952 and recently in 2007. We should filter the data first for year 1952. Let's have a quick look at it before visualising.



```{r, echo=FALSE}
gapminder_1952 <- gapminder %>%
  filter( year == 1952 )

gapminder_1952

```

Now let's have a look at the visualizations. We are interested in a GDP per capita vs life expectancy to evaluate the performance of various countries and continents. Rich and healthy countries will be present in the **top right** corner of the plot while the poor and unhealthy countries will be present on the **bottom left**.


```{r, echo=FALSE, message=FALSE}

ggplot(gapminder, aes(x = pop)) +
  geom_histogram() +
  theme_minimal()

ggplot(gapminder, aes(x = pop)) +
  geom_histogram() +
  scale_x_log10() +
  theme_minimal()

ggplot(gapminder, aes(x = gdpPercap)) +
  geom_histogram() +
  theme_minimal()

ggplot(gapminder, aes(x = gdpPercap)) +
  geom_histogram() +
  scale_x_log10() +
  theme_minimal()

ggplot(gapminder, aes(x = lifeExp)) +
  geom_histogram() +
  theme_minimal()


# Summarize the median gdpPercap by year & continent, save as by_year_continent
by_year_continent <- gapminder %>%
  group_by(continent, year) %>%
  summarize(medianGdpPercap = median(gdpPercap))

# Create a line plot showing the change in medianGdpPercap by continent over time
ggplot(by_year_continent, aes(x = year, y = medianGdpPercap, color = continent)) +
  geom_line() +
  expand_limits(y = 0) +
  theme_minimal()

ggplot(gapminder, aes(continent, pop)) + geom_boxplot(notch = TRUE, outlier.colour = "red") + scale_y_log10() + geom_jitter(width = 0.2)

ggplot(gapminder, aes(x = gdpPercap, y = lifeExp, color = continent, size = pop)) +
  geom_point() +
  scale_x_log10() +
  facet_wrap( ~ year )

Asia <- gapminder %>%
  filter( continent == "Asia")

Europe <- gapminder %>%
  filter( continent == "Europe")



```

Here we saw that most of the countries were poor and unhealthy especially the countries from Africa and Asia. North American countries were leading in better GDP per capita and higher life expectancy. In next plot we will connect the countries with each other based upon the similar continent.


```{r, echo=FALSE}
#ggplot(gapminder_1952, aes(x = country, y = gdpPercap, color = continent)) + geom_col() + theme_minimal()
ggplot(gapminder_1952, aes(x = lifeExp, y = gdpPercap, color = continent)) + 
  geom_line(aes(group = continent)) + 
  theme_minimal() + 
  ggtitle("countries in a continent connected by lines in year 1952")
```

Here we can see Kuwait had huge variations in their GDP because of hard conditions in the country in 80's. It faced a stock market crash in that decade followed by huge drop in oil prices which accounts a major part of economy. Before it could recover from these two events it also faced Gulf war in the middle east.


```{r, echo=FALSE}
#options(scipen = 10000)

ggplot(gapminder_1952, aes(x = lifeExp, y = gdpPercap, color = continent, size = pop)) + 
  geom_point() + 
  theme_minimal() + 
  scale_y_log10() + 
  ggtitle(" Adjusted gdpPercap vs lifeExp in year 1952")

```

## Fast forward to 2007


Lets filter the data for year 2007 and visualise it for analysis.
```{r, echo=FALSE}
gapminder_2007 <- gapminder %>%
  filter( year == 2007 )

gapminder_2007

ggplot(gapminder_2007, aes(x = lifeExp, y = gdpPercap, color = continent, size = pop)) + 
  geom_point() + 
  theme_minimal() + 
  ggtitle("gdpPercap vs lifeExp in year 2007")
```

##Insights

1. After the analysis we can clearly see that most countries from Europr have made progress in terms of gdpPercap and lifeExp both, whereas most of the countries from Africa are still having lower gdpPercap and lifeExp.

2. Populous countries including India and China have shown a huge increase in lifeExp but with minor improvement in gdpPercap.
```{r, echo=FALSE}
ggplot(gapminder_2007, aes(x = lifeExp, y = gdpPercap, color = continent, size = pop)) + 
  geom_point() + 
  theme_minimal() + 
  scale_y_log10() + 
  ggtitle("Adjusted gdpPercap vs lifeExp in year")


ggplot(gapminder_2007, aes(x = lifeExp, y = gdpPercap, color = continent)) + 
  geom_line(aes(group = continent)) + 
  theme_minimal() + 
  ggtitle("countries in a continent connected by lines in year 2007")
```





```{r, echo=FALSE}
gapminder_1952 <- gapminder %>%
  filter( year == 1952) %>%
  group_by(continent, year) %>%
  summarize(medianLifeExp = median(lifeExp),
            medianGdpPercap = median(gdpPercap))


gapminder_1952

ggplot(gapminder_1952, aes(x = reorder(continent, medianGdpPercap), y = medianGdpPercap, fill = continent)) + geom_col() + 
  theme_minimal() + 
  ggtitle("MedianGdpPercap varying among continents in decreasing order in Year 1952") + 
  coord_flip()

```

3. Here for the first time we came across the fact that Oceania continent which was hidden among rest large continents had a significantly higher medianGdpPercap followed by Europe and Americas.


```{r, echo=FALSE}
gapminder_2007 <- gapminder %>%
  filter( year == 2007) %>%
  group_by(continent, year) %>%
  summarize(medianLifeExp = median(lifeExp),
            medianGdpPercap = median(gdpPercap))


gapminder_2007
```

4. In 2007, here we can see that Oceania still has the highest medianGdpPercap but Europe has made significant progress and now has a very small difference that Oceania.

```{r, echo=FALSE}
ggplot(gapminder_2007, aes(x = reorder(continent, medianGdpPercap), y = medianGdpPercap, fill = continent)) + geom_col() + 
  theme_minimal() + 
  ggtitle("MedianGdpPercap varying among continents in decreasing order in Year 2007") +
  coord_flip()

ggplot(gapminder, aes(x = lifeExp, y = gdpPercap, color = country)) + 
  geom_line() + 
  theme_minimal() + 
  theme(legend.position = "none") + 
  geom_dl(aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))

gapminder %>%
  filter( country == "Kuwait" ) %>%
  group_by(year)


US_bylifeExp <- gapminder %>%
  filter( country == "United States") %>%
  arrange(lifeExp)
US_bylifeExp

ggplot(US_bylifeExp, aes(x = as.factor(year), y = lifeExp, fill = as.factor(year))) + 
  geom_col() + 
  coord_flip()

America_bylifeExp <- gapminder %>%
   filter( continent == "Americas") %>%
   arrange(desc(lifeExp))

America_bylifeExp
```




